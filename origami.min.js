// ┌───────────────────────────────────────────────────────────────────────┐
// │ Origami - Make pretty 'folding' animations using suites or equations. │
// ├───────────────────────────────────────────────────────────────────────┤
// │ Created by Jeremie T. Under MIT License.                              │
// └───────────────────────────────────────────────────────────────────────┘
(function(c){var a=document.createElement("div");var b=(function(){var f=/^(Moz|(w|W)ebkit|O|ms)(?=[A-Z])/,e="";for(var g in a.style){if(f.test(g)){e=g.match(f)[0]}}return"-"+e.toLowerCase()+"-"})();function d(f){for(var e in f){f[b+e]=f[e]}return f}c.fn.origami=function(e){var s=c(this),p=s.children("img"),f=p.attr("src"),g=p[0].naturalWidth,v=p[0].naturalHeight,j="";this.enabled=b+"Perspective" in a.style;e.frags||(e.frags=5);var o=0;for(o=1;o<=e.frags;o++){j+='<div class="fragment frag'+o+'">'}for(o=1;o<=e.frags;o++){j+="</div>"}s.find("img").hide().end().append(c(j)).find(".fragment").css("background-image","url("+f+")").prepend(c('<span class="overlay" ></span>'));var k=s.find(".back"),r=s.find(".fragment"),m=s.find(".overlay");s.css({width:g,height:v});k.css({position:"absolute",right:(s[0].offsetWidth-g)>>1,"max-height":v,"max-width":g,"z-index":0});var u=g/e.frags;r.css("width",u+1);r.each(function(i,x){c(x).css({"background-position":"-"+u*i+"px 0px","transform-style":"preserve-3d","transform-origin":"left center",transition:"translate3d("+u+"px, 0, 0)"})});r.not(".frag1").css(d({transform:"translate3d("+u+"px, 0, 0)"}));m.css({width:u,opacity:0});m.css(d({transition:"opacity "+(e.delay||42)/100+"s ease-in-out"}));if(e.shadows){function t(y,x){var i="";i+="linear-gradient(right,rgba(0, 0, 0, "+y+") 0%,";i+="rgba(0, 0, 0, "+x+") 100%)";return b+i}function l(y,A){var x,z,B;x=[];for(z=0;z<y.length;z++){B=(y[z]-0.5)*A+0.5;if(B<0){B=0}else{if(B>1){B=1}}x.push(B)}return x}}if(e.f){var w=(function(){var y=[],i;for(i=0;i<e.frags;i++){y.push(e.f(i))}return y})()}else{if(e.suite){var w=(function(){var y=[],i,z=function(x){return e.suite.type==="geo"?x*=e.suite.pas:x+=e.suite.pas};for(i=0,n=e.suite.n;i<e.frags;i++,n=z(n)){y.push(n)}return y})()}else{throw new TypeError("Suite or Equation are required.")}}function q(){var C="translate3d("+(u-1)+"px,0,0)",y;r.each(function(D,E){y="rotate3d(0,1,0,"+-(w[D]-(w[D-1]||0))+"deg)";if(D){y=C+" "+y}c(E).css(d({transform:y,"transition-delay":(e.frags-D-1)*(e.delay||42)+"ms"}))});if(!e.shadows){return}var x=[],B,A=0.6;for(var z=0;z<w.length;z++){x.push(1-(((w[z]+180)/360)%1))}x=l(x,2);m.each(function(E,D){B=x[E];c(D).css({background:t(B,A),opacity:1});A=B})}function h(){var x="translate3d("+u+"px,0,0)",i;r.each(function(y,z){i="rotate3d(0,1,0,0deg)";if(y){i=x+" "+i}c(z).css(d({transform:i}))});if(e.shadows){m.css({opacity:"0"})}}s.addClass("origami");return{on:q,off:h}}})(jQuery);